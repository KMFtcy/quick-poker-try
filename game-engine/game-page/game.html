<script type="importmap">
  {
    "imports": {
      "vue": "https://unpkg.com/vue@3/dist/vue.esm-browser.js"
    }
  }
</script>

<link rel="stylesheet" href="game.css" />

<div id="app">
  <div class="table" aria-label="Texas Hold'em Table">
    <div class="felt">
      <div class="community" aria-label="Community Cards">
        <div class="card-slot" v-for="(card, idx) in communitySlots" :key="idx">
          <img v-if="card" :src="cardImageUrl(card)" :alt="card" />
        </div>
      </div>

      <div class="pot" aria-label="Pot">POT: 0</div>

      <div class="seat-ring" aria-label="Seats">
        <div class="seat" style="--angle: 0deg; --seat-distance: 200px">
          <span class="label">1</span>
        </div>
        <div class="seat" style="--angle: 55deg; --seat-distance: 300px">
          <span class="label">2</span>
        </div>
        <div class="seat" style="--angle: 80deg; --seat-distance: 400px">
          <span class="label">3</span>
        </div>
        <div class="seat" style="--angle: 110deg; --seat-distance: 370px">
          <span class="label">4</span>
        </div>
        <div class="seat" style="--angle: 140deg; --seat-distance: 230px">
          <span class="label">5</span>
        </div>
        <div class="seat" style="--angle: 220deg; --seat-distance: 230px">
          <span class="label">6</span>
        </div>
        <div class="seat" style="--angle: 250deg; --seat-distance: 370px">
          <span class="label">7</span>
        </div>
        <div class="seat" style="--angle: 280deg; --seat-distance: 400px">
          <span class="label">8</span>
        </div>
        <div class="seat" style="--angle: 305deg; --seat-distance: 300px">
          <span class="label">9</span>
        </div>
      </div>

      <!-- <div class="dealer-btn" title="Dealer">D</div> -->

      <!-- Player 1 hole cards in front of seat 1 -->
      <div
        class="hole-cards"
        style="--angle: 0deg; --hole-distance: 280px"
        aria-label="Seat 1 Hole Cards"
      >
        <div
          class="card-slot small"
          v-for="(card, idx) in player1Slots"
          :key="idx"
        >
          <img v-if="card" :src="cardImageUrl(card)" :alt="card" />
        </div>
      </div>
      <!-- Other seats: show card backs -->
      <div
        class="hole-cards"
        v-for="(angle, i) in otherSeatsAngles"
        :key="`back-` + i"
        :style="`--angle: ${angle}deg; --hole-distance: ${otherSeatsDistances[i]}px`"
        aria-label="Other Seat Hole Cards"
      >
        <div class="card-slot small">
          <img
            src="https://deckofcardsapi.com/static/img/back.png"
            alt="Card back"
          />
        </div>
        <div class="card-slot small">
          <img
            src="https://deckofcardsapi.com/static/img/back.png"
            alt="Card back"
          />
        </div>
      </div>
    </div>
  </div>
</div>

<script type="module">
  import { createApp } from "vue";

  createApp({
    data() {
      return {
        communityCards: [],
        player1Cards: [],
        otherSeatsAngles: [55, 80, 120, 150, 210, 240, 280, 305],
        otherSeatsDistances: [420, 570, 550, 420, 420, 520, 560, 440],
      };
    },
    mounted() {
      // 皇家同花顺（黑桃 10, J, Q, K, A）
      const royalSpades = ["0S", "JS", "QS", "KS", "AS"]; // Deck of Cards API codes
      this.communityCards = royalSpades;
      // 示例：玩家1两张黑桃手牌（可替换）
      this.player1Cards = ["AS", "KS"]; // A♠, K♠
    },
    methods: {
      cardImageUrl(code) {
        return `https://deckofcardsapi.com/static/img/${code}.png`;
      },
    },
    computed: {
      communitySlots() {
        const slots = new Array(5).fill(null);
        for (let i = 0; i < Math.min(5, this.communityCards.length); i += 1) {
          slots[i] = this.communityCards[i];
        }
        return slots;
      },
      player1Slots() {
        const slots = new Array(2).fill(null);
        for (let i = 0; i < Math.min(2, this.player1Cards.length); i += 1) {
          slots[i] = this.player1Cards[i];
        }
        return slots;
      },
    },
  }).mount("#app");
</script>
